# V4 å…³å¡ç”Ÿæˆç³»ç»Ÿ - äº¤æ¥æ–‡æ¡£

> **ç‰ˆæœ¬**: 3.0  
> **æ›´æ–°æ—¥æœŸ**: 2026-01-19  
> **çŠ¶æ€**: æœ€æ–°ç‰ˆæœ¬ - åŒ…å«ä¸–ç•Œç”Ÿæˆå™¨æ‰©å±•

---

## ğŸ“‹ æ–‡æ¡£ç›®çš„

æœ¬æ–‡æ¡£ç”¨äºäº¤æ¥ Level Generation V4 å…³å¡ç”Ÿæˆç³»ç»Ÿçš„æœ€æ–°çŠ¶æ€ï¼ŒåŒ…å«ï¼š
1. **æˆ¿é—´ç”Ÿæˆå™¨ (RoomGeneraton)** - å•æˆ¿é—´å¾®è§‚ç”Ÿæˆ
2. **ä¸–ç•Œç”Ÿæˆå™¨ (WorldGeneration)** - å¤šæˆ¿é—´å®è§‚å¸ƒå±€ **ã€æ–°å¢ã€‘**

---

## ğŸ”„ ç‰ˆæœ¬æ›´æ–°æ‘˜è¦

### v3.0 é‡å¤§æ›´æ–° (2026-01-19)

| æ›´æ–°é¡¹ | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| **WorldGeneration æ¨¡å—** | **æ–°å¢** | **å®è§‚å¸ƒå±€ç”Ÿæˆç³»ç»Ÿ** |
| BezierSpineStrategy | æ–°å¢ | è´å¡å°”è„ŠæŸ±ç®—æ³•ç”Ÿæˆå…³é”®è·¯å¾„ |
| RegionalRandomStrategy | æ–°å¢ | åŒºåŸŸéšæœºæ‰©å±•æ”¯çº¿æˆ¿é—´ |
| DungeonContext æ‰©å±• | å¢å¼º | æ”¯æŒå¤–éƒ¨é—¨çº¦æŸæ³¨å…¥ |
| TilemapFinder å·¥å…·ç±» | æ–°å¢ | è‡ªåŠ¨è¯†åˆ« Tilemap å’Œ TileConfigData |
| æ¸²æŸ“è§„åˆ™è‡ªåŠ¨æŸ¥æ‰¾ | å¢å¼º | Inspector ä¸€é”®è‡ªåŠ¨å¡«å……å¼•ç”¨ |
| TileConfigData ä¿®å¤ | ä¿®å¤ | æ–‡ä»¶åä¸ç±»ååŒ¹é… |

### v2.0 æ›´æ–° (2026-01-19)

| æ›´æ–°é¡¹ | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| RoomNode structâ†’class | æ¶æ„é‡æ„ | è§£å†³å€¼æ‹·è´é™·é˜±é—®é¢˜ |
| BorderEnforcementRule | æ–°å¢è§„åˆ™ | æ›¿ä»£ WallRenderRuleï¼Œæ•°æ®é©±åŠ¨è¾¹ç•Œ |
| Bottom-Up å¹³å°ç®—æ³• | ç®—æ³•é‡æ„ | æ¨¡æ‹Ÿæ”€çˆ¬ + åŒ…å›´ç›’ç¢°æ’æ£€æµ‹ |
| ç”Ÿæˆé‡è¯•æœºåˆ¶ | åŠŸèƒ½å¢å¼º | å¤±è´¥è‡ªåŠ¨åˆ·æ–°ç§å­é‡è¯• |

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### åŒå±‚æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ã€æ–°å¢ã€‘ WorldGenerator (ä¸–ç•Œæ§åˆ¶å™¨)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    å¸ƒå±€ç­–ç•¥ (Layout Strategies)                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ BezierSpineStrategy â”‚  â†’   â”‚    RegionalRandomStrategy       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    (è´å¡å°”è„ŠæŸ±)       â”‚      â”‚        (åŒºåŸŸéšæœº)               â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“ è¾“å‡º WorldNode[]                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      WorldContext (ä¸–ç•Œé»‘æ¿)                        â”‚ â”‚
â”‚  â”‚    List<WorldNode> + AdjacencyGraph + PipelineRegistry             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“ æ¡¥æ¥ (ConstraintInjector)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         RoomGenerationQueue â†’ æ‰¹é‡è°ƒç”¨ V4 æˆ¿é—´ç”Ÿæˆç®¡çº¿               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ æ¯ä¸ª WorldNode å¯¹åº”ä¸€ä¸ª
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DungeonGenerator (æˆ¿é—´æ§åˆ¶å™¨)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                DungeonPipelineData (SO)                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚  â”‚ Macro   â”‚â†’â”‚ Micro   â”‚â†’â”‚ Border  â”‚â†’â”‚ Render  â”‚                  â”‚ â”‚
â”‚  â”‚  â”‚ Rules   â”‚ â”‚ Rules   â”‚ â”‚ Rules   â”‚ â”‚ Rules   â”‚                  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   DungeonContext (æˆ¿é—´é»‘æ¿)                         â”‚ â”‚
â”‚  â”‚  ã€æ–°å¢ã€‘ExternalDoorConstraint - æ¥è‡ªä¸–ç•Œå±‚çš„é—¨çº¦æŸ                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµå‘

```
ã€ä¸–ç•Œå±‚ã€‘
WorldGenerator
    â†“ BezierSpineStrategy (ç”Ÿæˆå…³é”®è·¯å¾„)
    â†“ RegionalRandomStrategy (æ‰©å±•æ”¯çº¿)
WorldContext (WorldNode[] + é‚»æ¥å›¾)
    â†“ ConstraintInjector (è®¡ç®—é—¨çº¦æŸ)
    â†“ RoomGenerationQueue (æ‰¹é‡è°ƒåº¦)

ã€æˆ¿é—´å±‚ã€‘(æ¯ä¸ª WorldNode)
DungeonGenerator
    â†“ Macroå±‚ (æˆ¿é—´å†…æ‹“æ‰‘)
    â†“ Microå±‚ (åœ°å½¢ç»†èŠ‚)
    â†“ Borderå±‚ (è¾¹ç•Œ+é—¨)
    â†“ Renderå±‚ (å¯è§†åŒ–)
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
LevelGenerationV4/
â”œâ”€â”€ RoomGeneraton/                     # æˆ¿é—´ç”Ÿæˆå™¨ (V4 åŸæœ‰)
â”‚   â”œâ”€â”€ Core/
â”‚   â”‚   â”œâ”€â”€ DungeonGenerator.cs        # æˆ¿é—´ä¸»æ§åˆ¶å™¨ ã€æ–°å¢è‡ªåŠ¨æŸ¥æ‰¾æŒ‰é’®ã€‘
â”‚   â”‚   â”œâ”€â”€ DungeonContext.cs          # æˆ¿é—´é»‘æ¿ ã€æ–°å¢å¤–éƒ¨çº¦æŸæ”¯æŒã€‘
â”‚   â”‚   â””â”€â”€ DungeonPipelineData.cs     # æˆ¿é—´ç®¡çº¿é…ç½®SO
â”‚   â”‚
â”‚   â”œâ”€â”€ Data/
â”‚   â”‚   â”œâ”€â”€ RoomNode.cs                # æˆ¿é—´èŠ‚ç‚¹ (class)
â”‚   â”‚   â”œâ”€â”€ RoomType.cs                # æˆ¿é—´ç±»å‹æšä¸¾
â”‚   â”‚   â”œâ”€â”€ TileConfigData.cs          # ç“¦ç‰‡é…ç½® ã€ä¿®å¤æ–‡ä»¶åã€‘
â”‚   â”‚   â”œâ”€â”€ TileId.cs                  # ç“¦ç‰‡IDæšä¸¾
â”‚   â”‚   â””â”€â”€ SpawnCommand.cs            # ç”ŸæˆæŒ‡ä»¤
â”‚   â”‚
â”‚   â”œâ”€â”€ Rules/
â”‚   â”‚   â”œâ”€â”€ Abstractions/              # è§„åˆ™æŠ½è±¡
â”‚   â”‚   â”œâ”€â”€ Macro/                     # å®è§‚è§„åˆ™
â”‚   â”‚   â”œâ”€â”€ Micro/                     # å¾®è§‚è§„åˆ™ (å« BorderEnforcementRule)
â”‚   â”‚   â””â”€â”€ Rendering/                 # æ¸²æŸ“è§„åˆ™ ã€æ–°å¢è‡ªåŠ¨æŸ¥æ‰¾æŒ‰é’®ã€‘
â”‚   â”‚
â”‚   â”œâ”€â”€ Utilities/
â”‚   â”‚   â””â”€â”€ TilemapFinder.cs           # ã€æ–°å¢ã€‘è‡ªåŠ¨æŸ¥æ‰¾å·¥å…·ç±»
â”‚   â”‚
â”‚   â””â”€â”€ Documentation/
â”‚       â””â”€â”€ HandoverDocument.md        # æœ¬æ–‡æ¡£
â”‚
â””â”€â”€ WorldGeneration/                   # ã€æ–°å¢ã€‘ä¸–ç•Œç”Ÿæˆå™¨
    â”œâ”€â”€ Core/
    â”‚   â”œâ”€â”€ WorldGenerator.cs          # ä¸–ç•Œä¸»æ§åˆ¶å™¨
    â”‚   â”œâ”€â”€ WorldContext.cs            # ä¸–ç•Œé»‘æ¿
    â”‚   â””â”€â”€ WorldPipelineData.cs       # ä¸–ç•Œç®¡çº¿é…ç½®SO
    â”‚
    â”œâ”€â”€ Data/
    â”‚   â”œâ”€â”€ WorldNode.cs               # ä¸–ç•ŒèŠ‚ç‚¹
    â”‚   â”œâ”€â”€ WorldNodeType.cs           # èŠ‚ç‚¹ç±»å‹æšä¸¾
    â”‚   â””â”€â”€ DoorConstraint.cs          # é—¨çº¦æŸæ•°æ®
    â”‚
    â”œâ”€â”€ Strategies/
    â”‚   â”œâ”€â”€ ILayoutStrategy.cs         # å¸ƒå±€ç­–ç•¥æ¥å£
    â”‚   â”œâ”€â”€ LayoutStrategyBase.cs      # ç­–ç•¥åŸºç±»
    â”‚   â”œâ”€â”€ BezierSpineStrategy.cs     # è´å¡å°”è„ŠæŸ±ç®—æ³•
    â”‚   â””â”€â”€ RegionalRandomStrategy.cs  # åŒºåŸŸéšæœºç®—æ³•
    â”‚
    â”œâ”€â”€ Bridge/
    â”‚   â”œâ”€â”€ CoordinateConverter.cs     # åæ ‡è½¬æ¢
    â”‚   â””â”€â”€ ConstraintInjector.cs      # çº¦æŸæ³¨å…¥å™¨
    â”‚
    â”œâ”€â”€ Queue/
    â”‚   â””â”€â”€ RoomGenerationQueue.cs     # å¼‚æ­¥ç”Ÿæˆé˜Ÿåˆ—
    â”‚
    â””â”€â”€ README.md                      # ä¸–ç•Œç”Ÿæˆå™¨æ–‡æ¡£
```

---

## ğŸ†• ä¸–ç•Œç”Ÿæˆå™¨è¯¦è§£

### WorldNode ç±»å‹

| ç±»å‹ | è¯´æ˜ | å…¸å‹ç”¨é€” |
|------|------|----------|
| `Entrance` | ä¸–ç•Œå…¥å£ | ç©å®¶èµ·å§‹ç‚¹ |
| `Exit` | ä¸–ç•Œå‡ºå£ | å…³å¡ç»ˆç‚¹ |
| `Corridor` | èµ°å»Šï¼ˆè„ŠæŸ±ï¼‰ | å…³é”®è·¯å¾„èŠ‚ç‚¹ |
| `Hall` | å¤§å…ï¼ˆæ”¯çº¿ï¼‰ | æ”¯çº¿æ¢ç´¢åŒºåŸŸ |
| `Treasure` | å®è—æˆ¿ | å¥–åŠ±æˆ¿é—´ |
| `Boss` | Bossæˆ¿ | Bossæˆ˜æ–—åŒºåŸŸ |

### å¸ƒå±€ç­–ç•¥

#### BezierSpineStrategyï¼ˆè´å¡å°”è„ŠæŸ±ï¼‰

**åŠŸèƒ½**: ä½¿ç”¨è´å¡å°”æ›²çº¿ç”Ÿæˆä¸–ç•Œä¸»å¹²é“ï¼ˆå…³é”®è·¯å¾„ï¼‰

**ç®—æ³•æµç¨‹**:
1. ç¡®å®šèµ·ç‚¹ï¼ˆé¡¶è¡Œï¼‰å’Œç»ˆç‚¹ï¼ˆåº•è¡Œï¼‰
2. éšæœºç”Ÿæˆ 1-3 ä¸ªä¸­é—´æ§åˆ¶ç‚¹
3. De Casteljau ç®—æ³•é‡‡æ ·æ›²çº¿
4. æ …æ ¼åŒ–ä¸ºç½‘æ ¼åæ ‡
5. Bresenham ç®—æ³•ä¿®è¡¥æ–­è£‚è·¯å¾„

**é…ç½®å‚æ•°**:

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| Control Point Count | 2 | æ§åˆ¶ç‚¹æ•°é‡ |
| Sample Step | 0.05 | é‡‡æ ·å¯†åº¦ |
| Horizontal Variance | 0.3 | æ°´å¹³åç§»èŒƒå›´ |
| Enable Path Repair | true | ä¿®è¡¥æ–­è£‚ |

#### RegionalRandomStrategyï¼ˆåŒºåŸŸéšæœºï¼‰

**åŠŸèƒ½**: ä»¥è„ŠæŸ±èŠ‚ç‚¹ä¸ºç§å­ï¼Œå‘å¤–å»¶ä¼¸ç”Ÿæˆæ”¯çº¿æˆ¿é—´

**ç®—æ³•æµç¨‹**:
1. éå†è„ŠæŸ±èŠ‚ç‚¹
2. æŒ‰æ¦‚ç‡å‘ 4 æ–¹å‘æ‰©å±•
3. é€’å½’æ‰©å±•è‡³æœ€å¤§æ·±åº¦
4. å¯é€‰éšæœºæ¸¸èµ°ç”Ÿæˆå¤æ‚åˆ†æ”¯
5. æœ«ç«¯èŠ‚ç‚¹å¯æˆä¸ºç‰¹æ®Šæˆ¿é—´

**é…ç½®å‚æ•°**:

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| Expansion Probability | 0.6 | æ‰©å±•æ¦‚ç‡ |
| Max Expansion Depth | 3 | æœ€å¤§æ·±åº¦ |
| Depth Decay Factor | 0.7 | æ·±åº¦è¡°å‡ |
| Treasure Room Probability | 0.15 | å®è—æˆ¿æ¦‚ç‡ |
| Boss Room Probability | 0.05 | Bossæˆ¿æ¦‚ç‡ |

### DungeonContext æ‰©å±•

```csharp
// ã€æ–°å¢ã€‘å¤–éƒ¨é—¨çº¦æŸï¼ˆç”±ä¸–ç•Œç”Ÿæˆå™¨æ³¨å…¥ï¼‰
public DoorConstraint? ExternalDoorConstraint { get; set; }

// ã€æ–°å¢ã€‘æ˜¯å¦ä¸ºä¸–ç•Œç”Ÿæˆæ¨¡å¼
public bool IsWorldGenerationMode { get; set; }

// ã€æ–°å¢ã€‘åœ¨ä¸–ç•Œä¸­çš„èŠ‚ç‚¹ä½ç½®
public Vector2Int WorldNodePosition { get; set; }
```

---

## ğŸ”§ è‡ªåŠ¨è¯†åˆ«åŠŸèƒ½

### Tilemap æ ‡ç­¾çº¦å®š

| Tag | å¯¹åº” Tilemap |
|-----|-------------|
| `Background` | èƒŒæ™¯å±‚ |
| `Ground` | åœ°é¢å±‚ |
| `Platform` | å¹³å°å±‚ |

### ä½¿ç”¨æ–¹æ³•

1. **è®¾ç½®æ ‡ç­¾**: ä¸ºæ¯ä¸ª Tilemap å¯¹è±¡è®¾ç½®å¯¹åº”çš„ Tag
2. **ç‚¹å‡»æŒ‰é’®**: åœ¨ Inspector ä¸­ç‚¹å‡» **"è‡ªåŠ¨æŸ¥æ‰¾å¼•ç”¨"** æŒ‰é’®
3. **ä¿å­˜èµ„äº§**: ä¿®æ”¹åè®°å¾—ä¿å­˜ Pipeline èµ„äº§

### æ”¯æŒçš„ç»„ä»¶

- `DungeonGenerator` - è‡ªåŠ¨æŸ¥æ‰¾æ‰€æœ‰ Tilemap + TileConfigData + CompositeCollider
- `RoomRenderRule` - è‡ªåŠ¨æŸ¥æ‰¾èƒŒæ™¯ Tilemap + TileConfigData
- `GroundRenderRule` - è‡ªåŠ¨æŸ¥æ‰¾åœ°é¢ Tilemap + TileConfigData
- `PlatformRenderRule` - è‡ªåŠ¨æŸ¥æ‰¾å¹³å° Tilemap + TileConfigData

---

## ğŸ”§ è§„åˆ™æ‰§è¡Œé¡ºåº

| Order | è§„åˆ™åç§° | ç±»å‹ | è¯´æ˜ |
|-------|----------|------|------|
| 10 | ConstrainedLayoutRule | Macro | é†‰æ±‰æ¸¸èµ°ç”Ÿæˆæˆ¿é—´æ‹“æ‰‘ |
| 20 | BFSValidationRule | Macro | BFSè¿é€šæ€§éªŒè¯ |
| 30 | CellularAutomataRule | Micro | CAåœ°å½¢ç”Ÿæˆ |
| 35 | EntranceExitRule | Micro | å…¥å£å‡ºå£æŒ–æ˜ |
| 36 | PathValidationRule | Micro | 2x2è·¯å¾„éªŒè¯ |
| 38 | BorderEnforcementRule | Micro | è¾¹ç•Œä¿éšœ |
| 40 | PlatformRule | Micro | å¹³å°ç”Ÿæˆ |
| 100 | RoomRenderRule | Render | èƒŒæ™¯æ¸²æŸ“ |
| 110 | GroundRenderRule | Render | åœ°é¢æ¸²æŸ“ |
| 120 | PlatformRenderRule | Render | å¹³å°æ¸²æŸ“ |

---

## ğŸš€ å¿«é€Ÿå…¥é—¨

### å•æˆ¿é—´ç”Ÿæˆ

```csharp
var generator = GetComponent<DungeonGenerator>();

// å¼‚æ­¥ç”Ÿæˆ
bool success = await generator.GenerateDungeonAsync(seed);

// å–æ¶ˆ/æ¸…ç†
generator.CancelGeneration();
generator.ClearGeneration();
```

### ä¸–ç•Œç”Ÿæˆ

```csharp
var worldGenerator = GetComponent<WorldGenerator>();

// ç”Ÿæˆæ•´ä¸ªä¸–ç•Œ
bool success = await worldGenerator.GenerateWorldAsync(seed);

// ä»…ç”Ÿæˆå¸ƒå±€ï¼ˆé¢„è§ˆï¼‰
bool layoutSuccess = await worldGenerator.GenerateLayoutOnlyAsync(seed);

// å–æ¶ˆ/æ¸…ç†
worldGenerator.CancelGeneration();
worldGenerator.ClearGeneration();
```

---

## âš ï¸ å½“å‰çŠ¶æ€ä¸å¾…åŠ

### âœ… å·²å®Œæˆ

- [x] ä¸–ç•Œç”Ÿæˆå™¨æ ¸å¿ƒæ¡†æ¶ (WorldGenerator, WorldContext, WorldPipelineData)
- [x] ä¸–ç•ŒèŠ‚ç‚¹æ•°æ®ç»“æ„ (WorldNode, DoorConstraint, WorldNodeType)
- [x] è´å¡å°”è„ŠæŸ±å¸ƒå±€ç­–ç•¥ (BezierSpineStrategy)
- [x] åŒºåŸŸéšæœºå¸ƒå±€ç­–ç•¥ (RegionalRandomStrategy)
- [x] åæ ‡è½¬æ¢ä¸çº¦æŸæ³¨å…¥ (CoordinateConverter, ConstraintInjector)
- [x] å¼‚æ­¥ç”Ÿæˆé˜Ÿåˆ— (RoomGenerationQueue)
- [x] DungeonContext å¤–éƒ¨çº¦æŸæ‰©å±•
- [x] è‡ªåŠ¨è¯†åˆ« Tilemap å’Œ TileConfigData
- [x] TileConfigData æ–‡ä»¶åä¿®å¤

### ğŸ”² å¾…å®ç°

- [ ] BorderEnforcementRule æ”¯æŒå¤–éƒ¨é—¨çº¦æŸ
- [ ] ä¸–ç•Œç”Ÿæˆå™¨é›†æˆæµ‹è¯•
- [ ] åˆ›å»º WorldPipelineData ç¤ºä¾‹èµ„äº§
- [ ] åˆ é™¤åºŸå¼ƒçš„ WallRenderRule.cs

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- `RoomGeneraton/README.md` - æˆ¿é—´ç”Ÿæˆå™¨å¿«é€Ÿå…¥é—¨
- `RoomGeneraton/TechnicalDoc.md` - æŠ€æœ¯ç»†èŠ‚
- `RoomGeneraton/APIReference.md` - APIå‚è€ƒ

---

> **æœ€åæ›´æ–°**: 2026-01-19  
> **æ–‡æ¡£ç‰ˆæœ¬**: 3.0
